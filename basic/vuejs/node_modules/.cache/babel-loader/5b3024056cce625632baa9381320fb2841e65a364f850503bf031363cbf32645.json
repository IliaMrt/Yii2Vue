{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport RandomCafeButton from \"@/components/RandomCafeButton.vue\";\nimport CafeComponent from \"@/components/CafeComponent.vue\";\nimport axios from \"axios\";\nconst host = 'http://193.32.203.137:7000';\nexport default {\n  name: \"Cafes-Component\",\n  components: {\n    CafeComponent,\n    RandomCafeButton\n  },\n  data() {\n    return {\n      cafes: []\n    };\n  },\n  mounted: async function () {\n    try {\n      //получаем от бэкенда список кафе\n      const cafes = JSON.parse((await axios.get(`${host}/api/default/get-cafes`)).data).data;\n      //получаем от бэкенда список кафе\n      const commentsMap = new Map()((await axios.get(`${host}/api/default/get-feedbacks-count`)).data).forEach(v => {\n        commentsMap.set(v.id_cafe, v.count);\n      });\n      cafes.forEach(e => {\n        e['show'] = true;\n        e['feedbacksCount'] = commentsMap.get(e.id) || 0;\n      });\n      this.cafes.push(...cafes);\n    } catch (e) {\n      console.log(JSON.stringify(e));\n    }\n  },\n  methods: {\n    async getFeedbacks(id) {\n      try {\n        return (await axios.get(`${host}/api/default/get-feedbacks-by-id?id=${id}`)).data;\n      } catch (e) {\n        console.log(JSON.stringify(e));\n      }\n    },\n    async saveFeedback(feedback) {\n      try {\n        await axios.post(`${host}/api/default/save-feedback`, feedback, {\n          headers: {\n            'content-type': 'multipart/form-data'\n          }\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    },\n    randomCafe() {\n      const id = Math.round(Math.random() * (this.cafes.length - 1));\n      this.cafes.map((v, i) => {\n        i != id ? v.show = false : v.show = true;\n      });\n    }\n  }\n};","map":{"version":3,"names":["RandomCafeButton","CafeComponent","axios","host","name","components","data","cafes","mounted","JSON","parse","get","commentsMap","Map","forEach","v","set","id_cafe","count","e","id","push","console","log","stringify","methods","getFeedbacks","saveFeedback","feedback","post","headers","randomCafe","Math","round","random","length","map","i","show"],"sources":["/home/oem/PhpstormProjects/Yii2Vue/basic/vuejs/src/components/CafesComponent.vue"],"sourcesContent":["<script>\n\nimport RandomCafeButton from \"@/components/RandomCafeButton.vue\";\nimport CafeComponent from \"@/components/CafeComponent.vue\";\nimport axios from \"axios\";\n\nconst host = 'http://193.32.203.137:7000'\n\nexport default {\n\n  name: \"Cafes-Component\",\n  components: {CafeComponent, RandomCafeButton},\n\n  data() {\n    return {\n      cafes: [],\n    }\n  },\n  mounted: async function () {\n    try {\n      //получаем от бэкенда список кафе\n      const cafes = (JSON.parse((await axios.get(`${host}/api/default/get-cafes`))\n          .data)).data\n      //получаем от бэкенда список кафе\n      const commentsMap = new Map()\n\n      ((await axios.get(`${host}/api/default/get-feedbacks-count`)).data).forEach((v) => {\n        commentsMap.set(v.id_cafe, v.count)\n      })\n      cafes.forEach(e => {\n        e['show'] = true;\n        e['feedbacksCount'] = commentsMap.get(e.id) || 0\n      })\n      this.cafes.push(...cafes)\n    } catch (e) {\n      console.log(JSON.stringify(e))\n    }\n  },\n\n\n  methods: {\n    async getFeedbacks(id) {\n\n      try {\n        return (await axios.get(`${host}/api/default/get-feedbacks-by-id?id=${id}`)).data\n\n      } catch (e) {\n        console.log(JSON.stringify(e))\n      }\n    },\n    async saveFeedback(feedback) {\n      try {\n        (await axios.post(`${host}/api/default/save-feedback`, feedback, {\n          headers: {\n            'content-type': 'multipart/form-data'\n          }\n        }))\n      } catch (e) {\n        console.log(e)\n      }\n\n    },\n    randomCafe() {\n      const id = Math.round(Math.random() * (this.cafes.length - 1))\n      this.cafes.map((v, i) => {\n        i != id ? v.show = false : v.show = true\n      })\n\n    },\n  }\n}\n\n</script>\n\n<template>\n  <div class=\".tc-cafes-wrapper\">\n    <div class=\"tc-cafes\">\n      <random-cafe-button @click=\"randomCafe\"/>\n      <cafe-component v-for=\"(cafe, index) in cafes\" :key=\"index\" :cafe=\"cafe\"/>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.tc-cafes-wrapper {\n}\n\n</style>"],"mappings":";AAEA,OAAOA,gBAAe,MAAO,mCAAmC;AAChE,OAAOC,aAAY,MAAO,gCAAgC;AAC1D,OAAOC,KAAI,MAAO,OAAO;AAEzB,MAAMC,IAAG,GAAI,4BAA2B;AAExC,eAAe;EAEbC,IAAI,EAAE,iBAAiB;EACvBC,UAAU,EAAE;IAACJ,aAAa;IAAED;EAAgB,CAAC;EAE7CM,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE;IACT;EACF,CAAC;EACDC,OAAO,EAAE,eAAAA,CAAA,EAAkB;IACzB,IAAI;MACF;MACA,MAAMD,KAAI,GAAKE,IAAI,CAACC,KAAK,CAAC,CAAC,MAAMR,KAAK,CAACS,GAAG,CAAE,GAAER,IAAK,wBAAuB,CAAC,EACtEG,IAAI,CAAC,CAAEA,IAAG;MACf;MACA,MAAMM,WAAU,GAAI,IAAIC,GAAG,CAAC,EAE3B,CAAC,MAAMX,KAAK,CAACS,GAAG,CAAE,GAAER,IAAK,kCAAiC,CAAC,EAAEG,IAAI,CAAC,CAACQ,OAAO,CAAEC,CAAC,IAAK;QACjFH,WAAW,CAACI,GAAG,CAACD,CAAC,CAACE,OAAO,EAAEF,CAAC,CAACG,KAAK;MACpC,CAAC;MACDX,KAAK,CAACO,OAAO,CAACK,CAAA,IAAK;QACjBA,CAAC,CAAC,MAAM,IAAI,IAAI;QAChBA,CAAC,CAAC,gBAAgB,IAAIP,WAAW,CAACD,GAAG,CAACQ,CAAC,CAACC,EAAE,KAAK;MACjD,CAAC;MACD,IAAI,CAACb,KAAK,CAACc,IAAI,CAAC,GAAGd,KAAK;IAC1B,EAAE,OAAOY,CAAC,EAAE;MACVG,OAAO,CAACC,GAAG,CAACd,IAAI,CAACe,SAAS,CAACL,CAAC,CAAC;IAC/B;EACF,CAAC;EAGDM,OAAO,EAAE;IACP,MAAMC,YAAYA,CAACN,EAAE,EAAE;MAErB,IAAI;QACF,OAAO,CAAC,MAAMlB,KAAK,CAACS,GAAG,CAAE,GAAER,IAAK,uCAAsCiB,EAAG,EAAC,CAAC,EAAEd,IAAG;MAElF,EAAE,OAAOa,CAAC,EAAE;QACVG,OAAO,CAACC,GAAG,CAACd,IAAI,CAACe,SAAS,CAACL,CAAC,CAAC;MAC/B;IACF,CAAC;IACD,MAAMQ,YAAYA,CAACC,QAAQ,EAAE;MAC3B,IAAI;QACD,MAAM1B,KAAK,CAAC2B,IAAI,CAAE,GAAE1B,IAAK,4BAA2B,EAAEyB,QAAQ,EAAE;UAC/DE,OAAO,EAAE;YACP,cAAc,EAAE;UAClB;QACF,CAAC,CAAC;MACJ,EAAE,OAAOX,CAAC,EAAE;QACVG,OAAO,CAACC,GAAG,CAACJ,CAAC;MACf;IAEF,CAAC;IACDY,UAAUA,CAAA,EAAG;MACX,MAAMX,EAAC,GAAIY,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,KAAK,IAAI,CAAC3B,KAAK,CAAC4B,MAAK,GAAI,CAAC,CAAC;MAC7D,IAAI,CAAC5B,KAAK,CAAC6B,GAAG,CAAC,CAACrB,CAAC,EAAEsB,CAAC,KAAK;QACvBA,CAAA,IAAKjB,EAAC,GAAIL,CAAC,CAACuB,IAAG,GAAI,KAAI,GAAIvB,CAAC,CAACuB,IAAG,GAAI,IAAG;MACzC,CAAC;IAEH;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}