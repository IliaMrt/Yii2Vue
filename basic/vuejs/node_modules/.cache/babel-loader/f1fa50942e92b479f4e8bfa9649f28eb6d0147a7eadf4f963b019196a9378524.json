{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-5f6b89d7\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \".tc-cafes-wrapper\"\n};\nconst _hoisted_2 = {\n  class: \"tc-cafes\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_random_cafe_button = _resolveComponent(\"random-cafe-button\");\n  const _component_cafe_component = _resolveComponent(\"cafe-component\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_random_cafe_button, {\n    onClick: $options.randomCafe\n  }, null, 8 /* PROPS */, [\"onClick\"]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cafes, (cafe, index) => {\n    return _openBlock(), _createBlock(_component_cafe_component, {\n      key: index,\n      cafe: cafe\n    }, null, 8 /* PROPS */, [\"cafe\"]);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_random_cafe_button","onClick","$options","randomCafe","_Fragment","_renderList","$data","cafes","cafe","index","_createBlock","_component_cafe_component","key"],"sources":["/home/oem/PhpstormProjects/Yii2Vue/basic/vuejs/src/components/CafesComponent.vue"],"sourcesContent":["<script>\n\nimport RandomCafeButton from \"@/components/RandomCafeButton.vue\";\nimport CafeComponent from \"@/components/CafeComponent.vue\";\nimport axios from \"axios\";\n\nexport default {\n  name: \"Cafes-Component\",\n  components: {CafeComponent, RandomCafeButton},\n  /*  data() {\n       return ((axios.get('http://localhost:8080/api')).then(v=> {\n         return {cafes: (JSON.parse(v.data)).data}\n       }))\n      // setTimeout(()=>return( {cafes:a}),1000)\n\n\n    }*/\n  data() {\n    return {\n      cafes: [],\n      feedbacksCount: new Map([[1, 111], [2, 222], [3, 333], [4, 444]])\n    }\n  },\n  mounted: async function () {\n    try {\n      const cafes = (JSON.parse((await axios.get('http://localhost:8080/api/default/get-cafes',\n          {/*mode:'cors',*/\n            headers: {\n              Accept: 'application/json',\n              'Content-Type': 'application/json'\n            }\n          }\n      )).data)).data\n      const feedCount = (await axios.get('http://localhost:8080/api/default/get-feedbacks-count')).data\n      let feedMap=new Map()\n       feedCount.forEach((v)=> {\n         feedMap.set(v.id_cafe,v.count)\n       })\n      cafes.forEach(e => {\n        e['show'] = true;\n        e['feedbacksCount'] = feedMap.get(e.cafe.id) || 0\n      })\n      this.cafes.push(...cafes)\n      // this.cafes.map(v => v['feedbacks'] = this.feedbacks.get(v.id) || 0)\n      // console.log(this.cafes)\n    } catch (e) {\n      alert(JSON.stringify(e))\n    }\n  },\n\n\n  methods: {\n    async getFeedbacks(id) {\n      // alert(id)\n      // alert(CafeComponent.data().cafes)\n      // alert(JSON.stringify(this))\n      // alert()\n      // const arrId=this.cafes.find(v=>v.id==id);\n      // this.cafes[arrId].feedbacks=['Not bad', 'Good!']\n      try {\n        return (await axios.get(`http://localhost:8080/api/default/get-feedbacks-by-id?id=${id}`)).data\n\n        /*  (JSON.parse((await axios.get(`http://localhost:8080/api/default/get-feedbacks-by-id?id=1`,\n            {\n              headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n              }\n            }\n        )).data)).data*/\n\n        // this.cafes.map(v => v['feedbacks'] = this.feedbacks.get(v.id) || 0)\n        // console.log(this.cafes)\n      } catch (e) {\n        // alert(JSON.stringify(e))\n      }\n    },\n    async saveFeedback(feedback){\n      try\n      {\n        alert((await axios.post(`http://localhost:8080/api/default/save-feedback`, feedback, {\n          headers: {\n            'content-type': 'multipart/form-data'\n          }\n        })))\n      } catch (e){alert(e)}\n\n    },\n    randomCafe() {\n      const id = Math.round(Math.random() * (this.cafes.length - 1))\n      console.log(id)\n      this.cafes.map((v, i) => {\n        i != id ? v.show = false : v.show = true\n      })\n      console.log(this.cafes)\n\n    }\n    ,\n\n  }\n}\n\n</script>\n\n<template>\n  <div class=\".tc-cafes-wrapper\">\n    <div class=\"tc-cafes\">\n      <random-cafe-button @click=\"randomCafe\"/>\n      <cafe-component v-for=\"(cafe, index) in cafes\" :key=\"index\" :cafe=\"cafe\"/>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.tc-cafes-wrapper {\n  margin: 10px 25% 10px 25%;\n  text-align: center;\n\n\n}\n\n</style>"],"mappings":";;;EAyGOA,KAAK,EAAC;AAAmB;;EACvBA,KAAK,EAAC;AAAU;;;;uBADvBC,mBAAA,CAKM,OALNC,UAKM,GAJJC,mBAAA,CAGM,OAHNC,UAGM,GAFJC,YAAA,CAAyCC,6BAAA;IAApBC,OAAK,EAAEC,QAAA,CAAAC;EAAU,uC,kBACtCR,mBAAA,CAA0ES,SAAA,QAAAC,WAAA,CAAlCC,KAAA,CAAAC,KAAK,GAArBC,IAAI,EAAEC,KAAK;yBAAnCC,YAAA,CAA0EC,yBAAA;MAA1BC,GAAG,EAAEH,KAAK;MAAGD,IAAI,EAAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}