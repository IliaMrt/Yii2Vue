{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport RandomCafeButton from \"@/components/RandomCafeButton.vue\";\nimport CafeComponent from \"@/components/CafeComponent.vue\";\nimport axios from \"axios\";\nexport default {\n  name: \"Cafes-Component\",\n  components: {\n    CafeComponent,\n    RandomCafeButton\n  },\n  /*  data() {\n       return ((axios.get('http://localhost:8080/api')).then(v=> {\n         return {cafes: (JSON.parse(v.data)).data}\n       }))\n      // setTimeout(()=>return( {cafes:a}),1000)\n      }*/\n  data() {\n    return {\n      cafes: [],\n      feedbacksCount: new Map([[1, 111], [2, 222], [3, 333], [4, 444]])\n    };\n  },\n  mounted: async function () {\n    try {\n      const cafes = JSON.parse((await axios.get('http://localhost:8080/api/default/get-cafes', {\n        /*mode:'cors',*/\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })).data).data;\n      const feedCount = (await axios.get('http://localhost:8080/api/default/get-feedbacks-count')).data;\n      let feedMap = []; //new Map([[1,2],[2,3]])\n      // feedMap=new Map()\n      // feedMap.set(1,2)\n      feedCount.forEach(v => {\n        // alert(v.id_cafe+' '+v.count)\n        feedMap.push([v.id_cafe, v.count]);\n      });\n      cafes.forEach(e => {\n        e['show'] = true;\n        console.log();\n        e['feedbacksCount'] = feedMap[feedMap.find(v => v[0] == e.id)][1] || 0;\n      });\n      this.cafes.push(...cafes);\n      // this.cafes.map(v => v['feedbacks'] = this.feedbacks.get(v.id) || 0)\n      // console.log(this.cafes)\n    } catch (e) {\n      alert(JSON.stringify(e));\n    }\n  },\n  methods: {\n    async getFeedbacks(id) {\n      // alert(id)\n      // alert(CafeComponent.data().cafes)\n      // alert(JSON.stringify(this))\n      // alert()\n      // const arrId=this.cafes.find(v=>v.id==id);\n      // this.cafes[arrId].feedbacks=['Not bad', 'Good!']\n      try {\n        return (await axios.get(`http://localhost:8080/api/default/get-feedbacks-by-id?id=${id}`)).data;\n\n        /*  (JSON.parse((await axios.get(`http://localhost:8080/api/default/get-feedbacks-by-id?id=1`,\n            {\n              headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n              }\n            }\n        )).data)).data*/\n\n        // this.cafes.map(v => v['feedbacks'] = this.feedbacks.get(v.id) || 0)\n        // console.log(this.cafes)\n      } catch (e) {\n        // alert(JSON.stringify(e))\n      }\n    },\n    async saveFeedback(feedback) {\n      try {\n        alert(await axios.post(`http://localhost:8080/api/default/save-feedback`, feedback, {\n          headers: {\n            'content-type': 'multipart/form-data'\n          }\n        }));\n      } catch (e) {\n        alert(e);\n      }\n    },\n    randomCafe() {\n      const id = Math.round(Math.random() * (this.cafes.length - 1));\n      console.log(id);\n      this.cafes.map((v, i) => {\n        i != id ? v.show = false : v.show = true;\n      });\n      console.log(this.cafes);\n    }\n  }\n};","map":{"version":3,"names":["RandomCafeButton","CafeComponent","axios","name","components","data","cafes","feedbacksCount","Map","mounted","JSON","parse","get","headers","Accept","feedCount","feedMap","forEach","v","push","id_cafe","count","e","console","log","find","id","alert","stringify","methods","getFeedbacks","saveFeedback","feedback","post","randomCafe","Math","round","random","length","map","i","show"],"sources":["/home/oem/PhpstormProjects/Yii2Vue/basic/vuejs/src/components/CafesComponent.vue"],"sourcesContent":["<script>\n\nimport RandomCafeButton from \"@/components/RandomCafeButton.vue\";\nimport CafeComponent from \"@/components/CafeComponent.vue\";\nimport axios from \"axios\";\n\nexport default {\n  name: \"Cafes-Component\",\n  components: {CafeComponent, RandomCafeButton},\n  /*  data() {\n       return ((axios.get('http://localhost:8080/api')).then(v=> {\n         return {cafes: (JSON.parse(v.data)).data}\n       }))\n      // setTimeout(()=>return( {cafes:a}),1000)\n\n\n    }*/\n  data() {\n    return {\n      cafes: [],\n      feedbacksCount: new Map([[1, 111], [2, 222], [3, 333], [4, 444]])\n    }\n  },\n  mounted: async function () {\n    try {\n      const cafes = (JSON.parse((await axios.get('http://localhost:8080/api/default/get-cafes',\n          {/*mode:'cors',*/\n            headers: {\n              Accept: 'application/json',\n              'Content-Type': 'application/json'\n            }\n          }\n      )).data)).data\n      const feedCount = (await axios.get('http://localhost:8080/api/default/get-feedbacks-count')).data\n      let feedMap=[]//new Map([[1,2],[2,3]])\n      // feedMap=new Map()\n      // feedMap.set(1,2)\n       feedCount.forEach((v)=> {\n         // alert(v.id_cafe+' '+v.count)\n         feedMap.push([v.id_cafe,v.count])\n       })\n\n      cafes.forEach(e => {\n        e['show'] = true;\n        console.log()\n        e['feedbacksCount'] = feedMap[feedMap.find(v=>v[0]==e.id)][1] || 0\n      })\n      this.cafes.push(...cafes)\n      // this.cafes.map(v => v['feedbacks'] = this.feedbacks.get(v.id) || 0)\n      // console.log(this.cafes)\n    } catch (e) {\n      alert(JSON.stringify(e))\n    }\n  },\n\n\n  methods: {\n    async getFeedbacks(id) {\n      // alert(id)\n      // alert(CafeComponent.data().cafes)\n      // alert(JSON.stringify(this))\n      // alert()\n      // const arrId=this.cafes.find(v=>v.id==id);\n      // this.cafes[arrId].feedbacks=['Not bad', 'Good!']\n      try {\n        return (await axios.get(`http://localhost:8080/api/default/get-feedbacks-by-id?id=${id}`)).data\n\n        /*  (JSON.parse((await axios.get(`http://localhost:8080/api/default/get-feedbacks-by-id?id=1`,\n            {\n              headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n              }\n            }\n        )).data)).data*/\n\n        // this.cafes.map(v => v['feedbacks'] = this.feedbacks.get(v.id) || 0)\n        // console.log(this.cafes)\n      } catch (e) {\n        // alert(JSON.stringify(e))\n      }\n    },\n    async saveFeedback(feedback){\n      try\n      {\n        alert((await axios.post(`http://localhost:8080/api/default/save-feedback`, feedback, {\n          headers: {\n            'content-type': 'multipart/form-data'\n          }\n        })))\n      } catch (e){alert(e)}\n\n    },\n    randomCafe() {\n      const id = Math.round(Math.random() * (this.cafes.length - 1))\n      console.log(id)\n      this.cafes.map((v, i) => {\n        i != id ? v.show = false : v.show = true\n      })\n      console.log(this.cafes)\n\n    }\n    ,\n\n  }\n}\n\n</script>\n\n<template>\n  <div class=\".tc-cafes-wrapper\">\n    <div class=\"tc-cafes\">\n      <random-cafe-button @click=\"randomCafe\"/>\n      <cafe-component v-for=\"(cafe, index) in cafes\" :key=\"index\" :cafe=\"cafe\"/>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.tc-cafes-wrapper {\n  margin: 10px 25% 10px 25%;\n  text-align: center;\n\n\n}\n\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}